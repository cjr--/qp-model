define(module,function(e,t){var n=t("qp-utility");n.make(e,{ns:"qp-model",create:function(e,t){e.create(t,{instance:this})},refresh:function(){},set_user:function(e){n.is(e,"array")&&(e=n.find(e,{id:this.user_id})),n.is(e,"user")&&(this.user=e,this.user_id=this.user.id)}})}),define(module,function(e,t){function n(){return""}function i(){return 0}function a(){return!1}function r(){return new Date}function u(){var e=new Date;return e.setUTCHours(12,0,0,0),e}var d=t("qp-utility");d.module(e,{ns:"qp-library/schema",build:function(e,t){t.create=this.create.bind(this,t.columns),t.table={name:t.table},t.fields={managed:[],all:[]},d.each_own(t.columns,function(e,n){e.name=n,e.managed?t.fields.managed.push(n):t.fields.all.push(n)}),e(t)},create:function(e,t,n){t=t||{};var i=(n=d.options(n,{internal:!1})).instance||{};return d.each_own(e,function(e,a){!n.internal&&e.internal||(i[a]=t[a]||e.default())}),i},field:function(e,t,f){d.is(t,"object")&&(f=t),t=0;var o;return o="text"===e?t?{type:"varchar",size:t,default:n}:{type:"text",default:n}:"int"===e||"integer"===e?2===t?{type:"smallint",default:i}:8===t?{type:"bigint",default:i}:{type:"integer",default:i}:"bool"===e||"boolean"===e?{type:"boolean",default:a}:"datetime"===e?{type:"date",default:r}:"date"===e?{type:"date",default:u}:{type:"",default:d.noop},d.options(o,f)},primary:function(){return this.field("int",64,{primary:!0,managed:!0})},foreign:function(e){return this.field("int",64,{foreign:!0,table:e})},foreign_ids:function(e){return this.field("int",64,{foreign:!0,table:e,array:!0})},created:function(){return this.field("datetime",{managed:!0})},modified:function(){return this.field("datetime",{managed:!0})}})});