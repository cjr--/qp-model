define(module,function(e,t){var n=t("qp-utility");n.make(e,{ns:"qp-model/model",create:function(e,t){e.create(t,{instance:this})},refresh:function(){},set_user:function(e){n.is(e,"array")&&(e=n.find(e,{id:this.user_id})),n.is(e,"user")&&(this.user=e,this.user_id=e.id)}})}),define(module,function(e,t){var n=t("qp-utility");function i(){return""}function a(){return 0}function r(){return!1}function u(){return new Date}function o(){return(new Date).setUTCHours(12,0,0,0)}n.module(e,{ns:"qp-model/schema",build:function(e,t){t.create=this.create.bind(this,t.columns),t.table={name:t.table},t.fields={managed:[],all:[]},n.each_own(t.columns,function(e,n){e.name=n,e.managed?t.fields.managed.push(n):t.fields.all.push(n)}),e(t)},create:function(e,t,i){return i=n.options(i,{internal:!1}),n.is(t,"array")?n.map(t,function(t){return this.create_item(e,t,{},i)}.bind(this)):n.is(t,"object")?this.create_item(e,t,i.instance||{},i):null},create_item:function(e,t,i,a){return n.is(t,"object")&&n.each_own(e,function(e,n){!a.internal&&e.internal||(i[n]=t[n]||e.default())}),i||{}},field:function(e,t,f){var d;return n.is(t,"object")&&(f=t),t=0,d="text"===e?t?{type:"varchar",size:t,default:i}:{type:"text",default:i}:"int"===e||"integer"===e?2===t?{type:"smallint",default:a}:8===t?{type:"bigint",default:a}:{type:"integer",default:a}:"bool"===e||"boolean"===e?{type:"boolean",default:r}:"datetime"===e?{type:"timestamp with time zone",default:u}:"date"===e?{type:"timestamp with time zone",default:o}:{type:"",default:n.noop},n.options(d,f)},primary:function(){return this.field("int",64,{primary:!0,managed:!0})},foreign:function(e){return this.field("int",64,{foreign:!0,table:e})},foreign_ids:function(e){return this.field("int",64,{foreign:!0,table:e,array:!0})},created:function(){return this.field("datetime",{managed:!0})},modified:function(){return this.field("datetime",{managed:!0})}})});